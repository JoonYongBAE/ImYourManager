<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>일정 등록</title>
    <style>
        #container {
            width: 600px;
            margin: 50px auto;
        }

        h2 {
            margin: 0 auto;
        }

        label {
            width: 80px;
            float: left;
            font-weight: bold;
        }

        ul>li {
            list-style: none;
            margin: 10px;
            line-height: 50px;
        }

        .buttons {
            width: 100%;
            margin-top: 20px;
            text-align: center;
            display: inline-block;
        }
    </style>
<!--TimePicker -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>
    <!--datepicker-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" integrity="sha512-aOG0c6nPNzGk+5zjwyJaoRUgCdOrfSDhmMID2u4+OIslr0GjpLKo7Xm0Ao3xmpM4T8AmIouRkqwj1nrdVsLKEQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/3.1.4/js/bootstrap-datetimepicker.min.js"></script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/3.1.4/css/bootstrap-datetimepicker.min.css">

</head>
<body>
<form action="/addSchedule" method="post">
    <div id="container">
        <fieldset>
            <legend>
                <h2>일정 등록</h2>
            </legend>
            <ul>

                <li><label for="day">날 짜</label> <input type='text' class='datepicker' id='day' name= 'day' style='width:140px;'required></li>
                <script>
                    $(function (){
                        $('.datepicker').datepicker({
                            format:'Y-m-d',
                            lang:'ko',
                            minDate:0
                        })
                    });
                </script>
                <li><label for="time">시간</label>
                    <input class="timepicker" type="text" id="start_time"  name="scheduleStartTime"  required placeholder="시작시간">
                     ~ <input class="timepicker" type="text" id="end_time" name="scheduleEndTime"  required placeholder="종료시간"></li>
                <script>

                        $(function (){

                        $('#start_time').timepicker({
                            timeFormat: 'h:mm p',
                            interval: 30,
                            dropdown: true,
                            scrollbar:true,
                            minTime:'24:00',
                            dynamic:true,
                            onClose:function (selectedTime){   //시간선택 됐을 때
                                $('#end_time').timepicker('option','minTime',selectedTime);  // 종료시간의 minTime 옵션을 selectedTime으로 지정.
                            }

                        });

                        $('#end_time').timepicker({
                            timeFormat: 'h:mm p',
                            interval: 30,
                            dropdown: true,
                            scrollbar:true,
                            onClose:function (selectedTime){
                                $('#start_time').timepicker('option','maxTime',selectedTime);  //선택된 시간을 시작시간의 maxTime으로 지정
                            }
                        });
                        });

                </script>
                <li><label for="ground">장 소</label> <input type="text"
                                                            id="ground" placeholder="ex)영등포공원 풋살장" required>
<!--                    <button>검색</button></li>  &lt;!&ndash;구장 검색 기능&ndash;&gt;-->
                <li><label  name="p_type">경기종류</label>
                    <input type="radio" name="p_type"  value="자체전" checked><span>자체전</span>
                    <input type="radio" name="p_type" 	value="매치"><span>매칭</span>
                </li>
<!--                <li><label name="vote">투표</label>-->
<!--                    <input type="radio"	name="vote"  value="1" checked><span>등록</span>-->
<!--                    <input type="radio" name="vote"  value="0"> <span>미등록</span>-->
<!--                </li>-->
            </ul>
        </fieldset>
        <div class="buttons">
            <button type="submit" id="submit" onclick="addSchedule()">등 록</button>
            <button type="reset" id="x">취 소</button>
        </div>

    </div>
</form>
<script>
    let obj = {
        "id" : '${id}',  // 로그인된 회원의 아이디
        "scheduleDate" : document.getElementById('day').value,   // 각각 인풋값 넣어주기
        "scheduleStartTime" : document.getElementById('start_time').value,
        "scheduleEndTime":document.getElementById('ground').value,
        "ground":document.getElementById('ground').value,
        "playType" : $('input:radio[name=p_type]:checked').value
    };
    //
    // var id = '${Id}';   // 회원의 ID를 넣어야함
    // var day = document.getElementById('day').value;
    // var start_time = document.getElementById('start_time').value;
    // var end_time = document.getElementById('end_time').value;
    // var ground = document.getElementById('ground').value;
    // var p_type = $('input:radio[name=p_type]:checked').value;
    // var schedule = [{id:id},day,start_time,end_time,ground,p_type}];  // schduleDTO 순서에 맞게 보내줌.(Controller에서 scheduleDTO로 받기 때문에)
    function addSchedule(){    // 전송버튼 눌렀을때 실행되는 함수
        $.ajax({
            type : "POST",
            url:'schedule/addSchedule',   // url 형식 확인필요 (데이터를 보낼곳)
            data: JSON.stringify(obj),   // 모든 입력값을 String으로 변환.
            success:function (data){
                console.log("success",data);
                alert("일정이 등록되었습니다.");
               // self.close();  //등록성공하면 메인페이지로 이동.
            },
            error:function (){
                console.log("fail");
            }

        });
        // form.target= opener.name;
        // form.submit();
        // if(opener !=null){
        //     opener.insert= null;
        //     self.close();
        // }

    };
</script>
</body>
</html>